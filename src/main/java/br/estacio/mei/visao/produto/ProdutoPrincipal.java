/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package br.estacio.mei.visao.produto;

import br.estacio.mei.dao.ProdutoDao;
import br.estacio.mei.dao.implementacao.FornecedorDaoEstatica;
import br.estacio.mei.dao.implementacao.ProdutoDaoEstatico;
import br.estacio.mei.model.Fornecedor;
import br.estacio.mei.model.Produto;
import java.util.ArrayList;
import javax.swing.JScrollPane;
import javax.swing.JLabel;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author aluno
 */
public class ProdutoPrincipal extends javax.swing.JPanel {
    ProdutoDao produtoDao = new ProdutoDaoEstatico();
    /**
     * Creates new form ProdutoPrincipal
     */
    public ProdutoPrincipal() {
        initComponents();
        msgErro.setVisible(false);
        produtos.setRowHeight(15);
               
        DefaultTableModel modeloDeColunasDaTabela = (DefaultTableModel)produtos.getModel();

        ArrayList<Produto> listaDeProdutos = produtoDao.buscarProdutos();
        for (int i=0; i< listaDeProdutos.size();i++)
        {
            Produto p = listaDeProdutos.get(i);
            Object[] dadosDaLinha = new Object[4];
            dadosDaLinha[0] = p.getCodigo();
            dadosDaLinha[1] = p.getNome();
            dadosDaLinha[2] = p.getFornecedor().getRazaoSocial();
            dadosDaLinha[3] = p.getCategoria();
            modeloDeColunasDaTabela.addRow(dadosDaLinha);
    }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        panelDinamico = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        novoProduto = new javax.swing.JButton();
        buscarProduto = new javax.swing.JButton();
        campoBusca = new javax.swing.JScrollPane();
        buscar = new javax.swing.JTextPane();
        tabelaProduto = new javax.swing.JScrollPane();
        produtos = new javax.swing.JTable();
        excluirProduto = new javax.swing.JButton();
        tipoPesquisa = new javax.swing.JComboBox<>();
        filtrarPor = new javax.swing.JLabel();
        panelErro = new javax.swing.JPanel();
        msgErro = new javax.swing.JLabel();

        setLayout(new java.awt.BorderLayout());

        panelDinamico.setLayout(new java.awt.BorderLayout());

        jPanel2.setBackground(new java.awt.Color(255, 255, 255));
        jPanel2.setToolTipText("");

        novoProduto.setBackground(new java.awt.Color(102, 102, 102));
        novoProduto.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icones/Incluir_black.png"))); // NOI18N
        novoProduto.setText("Novo Produto");
        novoProduto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                novoProdutoActionPerformed(evt);
            }
        });

        buscarProduto.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icones/re_search.png"))); // NOI18N
        buscarProduto.setText("Buscar");
        buscarProduto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buscarProdutoActionPerformed(evt);
            }
        });

        buscar.setToolTipText("");
        buscar.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        campoBusca.setViewportView(buscar);

        produtos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Codigo", "Categoria", "Nome", "Fornecedor"
            }
        ));
        tabelaProduto.setViewportView(produtos);

        excluirProduto.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icones/cancel.png"))); // NOI18N
        excluirProduto.setText("Excluir Produto");

        tipoPesquisa.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Código", "Nome", "Fornecedor", "Preço de Compra", "Preço de Venda", "Qtde Estoque" }));
        tipoPesquisa.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tipoPesquisaActionPerformed(evt);
            }
        });

        filtrarPor.setText("Filtrar por");

        msgErro.setText("Erros");

        javax.swing.GroupLayout panelErroLayout = new javax.swing.GroupLayout(panelErro);
        panelErro.setLayout(panelErroLayout);
        panelErroLayout.setHorizontalGroup(
            panelErroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelErroLayout.createSequentialGroup()
                .addGap(461, 461, 461)
                .addComponent(msgErro)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        panelErroLayout.setVerticalGroup(
            panelErroLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(msgErro, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 25, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(panelErro, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(tabelaProduto, javax.swing.GroupLayout.DEFAULT_SIZE, 946, Short.MAX_VALUE)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(filtrarPor, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(tipoPesquisa, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(campoBusca, javax.swing.GroupLayout.PREFERRED_SIZE, 302, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(buscarProduto)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(novoProduto)
                        .addGap(35, 35, 35)
                        .addComponent(excluirProduto)))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(38, 38, 38)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(buscarProduto)
                            .addComponent(novoProduto, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(excluirProduto, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(tipoPesquisa, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(filtrarPor, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(campoBusca, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(18, 18, 18)
                .addComponent(panelErro, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(tabelaProduto, javax.swing.GroupLayout.DEFAULT_SIZE, 257, Short.MAX_VALUE)
                .addGap(27, 27, 27))
        );

        panelDinamico.add(jPanel2, java.awt.BorderLayout.CENTER);

        add(panelDinamico, java.awt.BorderLayout.CENTER);
    }// </editor-fold>//GEN-END:initComponents

    private void novoProdutoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_novoProdutoActionPerformed
       DadosProduto dadosProduto = new DadosProduto();
        panelDinamico.removeAll();
        panelDinamico.add(dadosProduto);
        panelDinamico.validate();
        panelDinamico.repaint();
    }//GEN-LAST:event_novoProdutoActionPerformed

    private void tipoPesquisaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tipoPesquisaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_tipoPesquisaActionPerformed
private void buscarProdutoActionPerformed(java.awt.event.ActionEvent evt) {                                             
        int itemSelecionado = tipoPesquisa.getSelectedIndex();
        DefaultTableModel modeloDeColunasDaTabela = (DefaultTableModel)produtos.getModel();
        switch(itemSelecionado) {
            case 0:
                try {
                    msgErro.setVisible(false);
                    int pesqCodigo = Integer.parseInt(buscar.getText());
                    while (modeloDeColunasDaTabela.getRowCount() != 0) {
                        modeloDeColunasDaTabela.removeRow(0);
                    }
                    ArrayList<Produto> produtosPorCodigo = produtoDao.pesquisarPorCodigo(pesqCodigo);
                    for (int i=0; i< produtosPorCodigo.size();i++)
                       {
                           Produto p = produtosPorCodigo.get(i);
                           Object[] dadosDaLinha = new Object[4];
                           dadosDaLinha[0] = p.getCodigo();
                           dadosDaLinha[1] = p.getNome();
                           dadosDaLinha[2] = p.getFornecedor().getRazaoSocial();
                           dadosDaLinha[3] = p.getCategoria();
                           modeloDeColunasDaTabela.addRow(dadosDaLinha);
                       }
                } catch (Exception e) {
                    msgErro.setText("Pesquisa Invalida!");
                    msgErro.setVisible(true);
                }

                break;
            case 1:
                try {
                    msgErro.setVisible(false);
                    String pesqNome = buscar.getText();
                    while (modeloDeColunasDaTabela.getRowCount() != 0) {
                        modeloDeColunasDaTabela.removeRow(0);
                    }
                    ArrayList<Produto> produtosPorNome = produtoDao.pesquisarPorNome(pesqNome);
                    for (int i=0; i< produtosPorNome.size();i++)
                    {
                        Produto p = produtosPorNome.get(i);
                        Object[] dadosDaLinha = new Object[4];
                        dadosDaLinha[0] = p.getCodigo();
                        dadosDaLinha[1] = p.getNome();
                        dadosDaLinha[2] = p.getFornecedor().getRazaoSocial();
                        dadosDaLinha[3] = p.getCategoria();
                        modeloDeColunasDaTabela.addRow(dadosDaLinha);
                    }    
                } catch (Exception e) {
                    msgErro.setText("Pesquisa Invalida!");
                    msgErro.setVisible(true);
                }
                break;
            case 2:
                try {
                    msgErro.setVisible(false);
                    String pesqFornecedor = buscar.getText();
                    while (modeloDeColunasDaTabela.getRowCount() != 0) {
                        modeloDeColunasDaTabela.removeRow(0);
                    }
                    ArrayList<Produto> produtosPorFornecedor = produtoDao.pesquisarPorFornecedor(pesqFornecedor);
                    for (int i=0; i< produtosPorFornecedor.size();i++)
                    {
                        Produto p = produtosPorFornecedor.get(i);
                        Object[] dadosDaLinha = new Object[4];
                        dadosDaLinha[0] = p.getCodigo();
                        dadosDaLinha[1] = p.getNome();
                        dadosDaLinha[2] = p.getFornecedor().getRazaoSocial();
                        dadosDaLinha[3] = p.getCategoria();
                        modeloDeColunasDaTabela.addRow(dadosDaLinha);
                    }
                } catch (Exception e) {
                    msgErro.setText("Pesquisa Invalida!");
                    msgErro.setVisible(true);
                }
                    break;
            case 3:
                try {
                    msgErro.setVisible(false);
                    int pesqCategoria = Integer.parseInt(buscar.getText());
                    while (modeloDeColunasDaTabela.getRowCount() != 0) {
                        modeloDeColunasDaTabela.removeRow(0);
                    }
                    ArrayList<Produto> produtosPorCategoria = produtoDao.pesquisarPorCategoria(pesqCategoria);
                    for (int i=0; i< produtosPorCategoria.size();i++)
                    {
                        Produto p = produtosPorCategoria.get(i);
                        Object[] dadosDaLinha = new Object[4];
                        dadosDaLinha[0] = p.getCodigo();
                        dadosDaLinha[1] = p.getNome();
                        dadosDaLinha[2] = p.getFornecedor().getRazaoSocial();
                        dadosDaLinha[3] = p.getCategoria();
                        modeloDeColunasDaTabela.addRow(dadosDaLinha);
                    }
                } catch (Exception e) {
                    msgErro.setText("Pesquisa Invalida!");
                    msgErro.setVisible(true);
                }
                    break;
           
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextPane buscar;
    private javax.swing.JButton buscarProduto;
    private javax.swing.JScrollPane campoBusca;
    private javax.swing.JButton excluirProduto;
    private javax.swing.JLabel filtrarPor;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JLabel msgErro;
    private javax.swing.JButton novoProduto;
    private javax.swing.JPanel panelDinamico;
    private javax.swing.JPanel panelErro;
    private javax.swing.JTable produtos;
    private javax.swing.JScrollPane tabelaProduto;
    private javax.swing.JComboBox<String> tipoPesquisa;
    // End of variables declaration//GEN-END:variables
}
